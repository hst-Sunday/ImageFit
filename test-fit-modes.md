# 图像缩放模式测试指南

## 问题修复

修复了当同时提供 `width` 和 `height` 参数时，图像不能按照预期尺寸缩放的问题。

## 新增的 fit 参数

现在支持以下缩放模式：

### 1. `fill` (默认模式) - 强制精确尺寸
- **行为**: 忽略原图宽高比，强制调整到目标尺寸
- **结果**: 精确的目标尺寸，可能会轻微变形
- **适用场景**: 需要精确尺寸，允许轻微变形

### 2. `cover` - 覆盖模式
- **行为**: 保持宽高比，完全覆盖目标尺寸
- **结果**: 可能会裁剪部分图像
- **适用场景**: 需要填满整个区域，不介意裁剪

### 3. `contain` (或 `inside`) - 包含模式
- **行为**: 保持宽高比，完全适应目标尺寸
- **结果**: 可能有空白区域，不会裁剪
- **适用场景**: 保持完整图像，允许空白

### 4. `outside` - 外部模式
- **行为**: 保持宽高比，确保至少一个维度等于目标尺寸
- **结果**: 图像可能超出目标尺寸

## 测试示例

### 原图: 1600x1600 → 目标: 1280x800

#### 使用 fill 模式 (默认):
```bash
curl -X POST http://localhost:8000/api/process \
  -F "image=@your-image.jpg" \
  -F "width=1280" \
  -F "height=800" \
  -F "fit=fill"
```
**结果**: 精确的 1280x800 图像

#### 使用 cover 模式:
```bash
curl -X POST http://localhost:8000/api/process \
  -F "image=@your-image.jpg" \
  -F "width=1280" \
  -F "height=800" \
  -F "fit=cover"
```
**结果**: 1280x800 图像，保持比例，可能裁剪

#### 使用 contain 模式:
```bash
curl -X POST http://localhost:8000/api/process \
  -F "image=@your-image.jpg" \
  -F "width=1280" \
  -F "height=800" \
  -F "fit=contain"
```
**结果**: 800x800 图像居中在 1280x800 画布中

## API 更新

### `/api/resize` 端点
新增 `fit` 参数:
- `fit=fill` (默认): 强制精确尺寸
- `fit=cover`: 覆盖模式
- `fit=contain` 或 `fit=inside`: 包含模式
- `fit=outside`: 外部模式

### `/api/process` 端点
同样支持所有 `fit` 参数选项。

## 向后兼容性

- 如果不提供 `fit` 参数，默认使用 `fill` 模式
- 这确保了精确的尺寸输出，解决了原来的问题
- 老的 API 调用仍然有效，但现在会得到精确的尺寸

## 测试验证

1. **默认行为测试** (不提供 fit 参数):
   - 应该得到精确的目标尺寸

2. **显式 fill 模式测试**:
   - 应该得到精确的目标尺寸

3. **其他模式测试**:
   - 验证不同模式的行为是否符合预期
